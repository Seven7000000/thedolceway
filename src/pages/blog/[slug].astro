---
import Layout from '../../layouts/Layout.astro';
import { getCollection, type CollectionEntry } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

type Props = {
  post: CollectionEntry<'blog'>;
};

const { post } = Astro.props;
const { Content, headings } = await post.render();

// Filter to only h2 headings for TOC
const tocHeadings = headings.filter(h => h.depth === 2);

// Calculate reading time (approx 200 words per minute)
const wordCount = post.body.split(/\s+/).length;
const readingTime = Math.ceil(wordCount / 200);

// Get related posts (same tag, different post)
const allPosts = await getCollection('blog');
const relatedPosts = allPosts
  .filter(p => p.slug !== post.slug && p.data.tags.some(tag => post.data.tags.includes(tag)))
  .slice(0, 3);

function formatDate(date: Date): string {
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  });
}

// Build canonical URL
const siteUrl = "https://thedolceway.com";
const canonicalUrl = `${siteUrl}/blog/${post.slug}`;

// JSON-LD BlogPosting schema
const blogPostSchema = {
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": post.data.title,
  "description": post.data.description,
  "image": post.data.image ? `${siteUrl}${post.data.image}` : `${siteUrl}/og-default.jpg`,
  "datePublished": post.data.date.toISOString(),
  "dateModified": post.data.date.toISOString(),
  "author": {
    "@type": "Person",
    "name": "Dolce",
    "url": `${siteUrl}/about`
  },
  "publisher": {
    "@type": "Organization",
    "name": "The Dolce Way",
    "logo": {
      "@type": "ImageObject",
      "url": `${siteUrl}/favicon.svg`
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": canonicalUrl
  },
  "wordCount": wordCount,
  "keywords": post.data.tags.join(", ")
};

// Breadcrumb schema for navigation
const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": siteUrl
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Blog",
      "item": `${siteUrl}/blog`
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": post.data.title,
      "item": canonicalUrl
    }
  ]
};

// Combined schema
const combinedSchema = [blogPostSchema, breadcrumbSchema];
---

<Layout
  title={`${post.data.title} | The Dolce Way`}
  description={post.data.description}
  ogImage={post.data.image || "/og-default.jpg"}
  canonicalUrl={canonicalUrl}
  jsonLd={combinedSchema}
  publishDate={post.data.date}
  articleType="article"
>
  <!-- Reading Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar" id="reading-progress"></div>
  </div>

  <article class="post-page" id="article">
    <!-- Header -->
    <header class="post-header">
      <div class="header-inner">
        <a href="/blog" class="back-link">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Blog
        </a>

        <div class="post-meta">
          <time datetime={post.data.date.toISOString()} class="post-date">{formatDate(post.data.date)}</time>
          <span class="meta-dot">·</span>
          <span class="reading-time">{readingTime} min read</span>
          <span class="meta-dot">·</span>
          <span class="post-author">Dolce</span>
        </div>

        <h1 class="post-title">{post.data.title}</h1>

        <p class="post-description">{post.data.description}</p>

        <div class="post-tags">
          {post.data.tags.map((tag) => (
            <span class="tag">{tag}</span>
          ))}
        </div>
      </div>
    </header>

    <!-- Featured Image -->
    {post.data.image && (
      <div class="featured-image">
        <div class="image-inner">
          <img
            src={post.data.image}
            alt={`Featured image for: ${post.data.title}`}
            width="800"
            height="450"
          />
        </div>
      </div>
    )}

    <!-- Table of Contents -->
    {tocHeadings.length > 2 && (
      <nav class="toc-section" aria-label="Table of Contents">
        <div class="toc-inner">
          <details class="toc-details" open>
            <summary class="toc-summary">
              <span class="toc-title">Table of Contents</span>
              <svg class="toc-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 9l6 6 6-6"/>
              </svg>
            </summary>
            <ol class="toc-list">
              {tocHeadings.map((heading) => (
                <li class="toc-item">
                  <a href={`#${heading.slug}`} class="toc-link">{heading.text}</a>
                </li>
              ))}
            </ol>
          </details>
        </div>
      </nav>
    )}

    <!-- Content -->
    <div class="post-content">
      <div class="content-inner">
        <div class="prose">
          <Content />
        </div>
      </div>
    </div>

    <!-- Share Buttons -->
    <section class="share-section">
      <div class="share-inner">
        <span class="share-label">Share this post</span>
        <div class="share-buttons">
          <a
            href={`https://twitter.com/intent/tweet?text=${encodeURIComponent(post.data.title)}&url=${encodeURIComponent(canonicalUrl)}&via=thedolceway`}
            target="_blank"
            rel="noopener noreferrer"
            class="share-btn share-twitter"
            aria-label="Share on Twitter"
          >
            <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
          </a>
          <a
            href={`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(canonicalUrl)}`}
            target="_blank"
            rel="noopener noreferrer"
            class="share-btn share-linkedin"
            aria-label="Share on LinkedIn"
          >
            <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
          </a>
          <a
            href={`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(canonicalUrl)}`}
            target="_blank"
            rel="noopener noreferrer"
            class="share-btn share-facebook"
            aria-label="Share on Facebook"
          >
            <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
          </a>
          <button
            class="share-btn share-copy"
            id="copy-link-btn"
            data-url={canonicalUrl}
            aria-label="Copy link"
          >
            <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
            <span class="copy-tooltip" id="copy-tooltip">Copied!</span>
          </button>
        </div>
      </div>
    </section>

    <!-- Author -->
    <section class="author-section" itemscope itemtype="https://schema.org/Person">
      <div class="author-inner">
        <div class="author-card">
          <a href="/about" class="author-avatar-link">
            <div class="author-avatar" itemprop="image">D</div>
          </a>
          <div class="author-info">
            <a href="/about" class="author-name-link">
              <p class="author-name" itemprop="name">Written by Dolce</p>
            </a>
            <p class="author-bio" itemprop="description">Solo developer. Built a $4M company. Now building 26 apps in public.</p>
            <meta itemprop="url" content="https://thedolceway.com/about" />
          </div>
          <a href="/connect" class="author-follow" rel="author">Follow</a>
        </div>
      </div>
    </section>

    <!-- Comments -->
    <section class="comments-section">
      <div class="comments-inner">
        <h2 class="comments-title">Comments</h2>
        <div id="giscus-container">
          <script
            src="https://giscus.app/client.js"
            data-repo="Seven7000000/thedolceway"
            data-repo-id="R_kgDOQ8Syqg"
            data-category="General"
            data-category-id="DIC_kwDOQ8Syqs4C1P7C"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="top"
            data-theme="dark"
            data-lang="en"
            data-loading="lazy"
            crossorigin="anonymous"
            async
          ></script>
        </div>
        <p class="comments-note">
          Comments powered by <a href="https://giscus.app" target="_blank" rel="noopener">Giscus</a>.
          Sign in with GitHub to comment.
        </p>
      </div>
    </section>

    <!-- Related Posts -->
    {relatedPosts.length > 0 && (
      <section class="related-section">
        <div class="related-inner">
          <h2 class="related-title">Keep reading</h2>
          <div class="related-grid">
            {relatedPosts.map((related) => (
              <a href={`/blog/${related.slug}`} class="related-card">
                <span class="related-date">{formatDate(related.data.date)}</span>
                <h3 class="related-heading">{related.data.title}</h3>
                <span class="related-link">Read →</span>
              </a>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- Footer CTA -->
    <section class="footer-cta">
      <div class="cta-inner">
        <p class="cta-text">Want updates when new posts drop?</p>
        <a href="/connect" class="cta-link">
          Follow the journey
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </a>
      </div>
    </section>
  </article>

  <!-- Back to Top Button -->
  <button class="back-to-top" id="back-to-top" aria-label="Back to top">
    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <path d="M18 15l-6-6-6 6"/>
    </svg>
  </button>
</Layout>

<style>
  /* Progress Bar */
  .progress-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: transparent;
    z-index: 1000;
  }

  .progress-bar {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #8b5cf6, #6366f1);
    transition: width 50ms ease-out;
  }

  /* Back to Top */
  .back-to-top {
    position: fixed;
    bottom: 32px;
    right: 32px;
    width: 48px;
    height: 48px;
    background: #8b5cf6;
    border: none;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transform: translateY(20px);
    transition: all 300ms ease;
    box-shadow: 0 4px 20px rgba(139, 92, 246, 0.3);
    z-index: 999;
  }

  .back-to-top.visible {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  .back-to-top:hover {
    background: #7c3aed;
    transform: translateY(-2px);
    box-shadow: 0 6px 24px rgba(139, 92, 246, 0.4);
  }

  /* Share Section */
  .share-section {
    padding: 0 24px 40px;
  }

  .share-inner {
    max-width: 680px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 16px;
    padding: 24px;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: 12px;
  }

  .share-label {
    font-size: 0.875rem;
    color: var(--text-muted);
  }

  .share-buttons {
    display: flex;
    gap: 8px;
  }

  .share-btn {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
    border: 1px solid var(--border);
    background: var(--bg-card);
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 200ms ease;
    text-decoration: none;
    position: relative;
  }

  .share-btn:hover {
    border-color: var(--accent);
    color: var(--accent);
    transform: translateY(-2px);
  }

  .share-twitter:hover { color: #1da1f2; border-color: #1da1f2; }
  .share-linkedin:hover { color: #0077b5; border-color: #0077b5; }
  .share-facebook:hover { color: #1877f2; border-color: #1877f2; }

  .copy-tooltip {
    position: absolute;
    bottom: calc(100% + 8px);
    left: 50%;
    transform: translateX(-50%);
    background: var(--text);
    color: var(--bg);
    font-size: 0.75rem;
    padding: 4px 8px;
    border-radius: 4px;
    white-space: nowrap;
    opacity: 0;
    visibility: hidden;
    transition: all 200ms ease;
  }

  .copy-tooltip.show {
    opacity: 1;
    visibility: visible;
  }

  /* Table of Contents */
  .toc-section {
    padding: 0 24px 40px;
  }

  .toc-inner {
    max-width: 680px;
    margin: 0 auto;
  }

  .toc-details {
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
  }

  .toc-summary {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    cursor: pointer;
    user-select: none;
    list-style: none;
  }

  .toc-summary::-webkit-details-marker {
    display: none;
  }

  .toc-title {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text);
  }

  .toc-chevron {
    color: var(--text-muted);
    transition: transform 200ms ease;
  }

  .toc-details[open] .toc-chevron {
    transform: rotate(180deg);
  }

  .toc-list {
    list-style: none;
    padding: 0 20px 16px;
    margin: 0;
    counter-reset: toc-counter;
  }

  .toc-item {
    counter-increment: toc-counter;
  }

  .toc-link {
    display: flex;
    align-items: baseline;
    gap: 12px;
    padding: 8px 0;
    font-size: 0.875rem;
    color: var(--text-secondary);
    text-decoration: none;
    border-bottom: 1px solid var(--border);
    transition: color 200ms ease;
  }

  .toc-item:last-child .toc-link {
    border-bottom: none;
  }

  .toc-link::before {
    content: counter(toc-counter, decimal-leading-zero);
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--accent);
    min-width: 20px;
  }

  .toc-link:hover {
    color: var(--accent);
  }

  @media (max-width: 600px) {
    .share-inner {
      flex-direction: column;
      gap: 12px;
    }

    .back-to-top {
      bottom: 20px;
      right: 20px;
      width: 44px;
      height: 44px;
    }

    .toc-section {
      padding: 0 16px 32px;
    }
  }
</style>

<script>
  // Reading Progress Bar
  const progressBar = document.getElementById('reading-progress');
  const article = document.getElementById('article');

  if (progressBar && article) {
    window.addEventListener('scroll', () => {
      const articleTop = article.offsetTop;
      const articleHeight = article.offsetHeight;
      const windowHeight = window.innerHeight;
      const scrollY = window.scrollY;

      const start = articleTop - windowHeight;
      const end = articleTop + articleHeight - windowHeight;
      const progress = Math.min(Math.max((scrollY - start) / (end - start), 0), 1);

      progressBar.style.width = `${progress * 100}%`;
    });
  }

  // Back to Top Button
  const backToTop = document.getElementById('back-to-top');

  if (backToTop) {
    window.addEventListener('scroll', () => {
      if (window.scrollY > 500) {
        backToTop.classList.add('visible');
      } else {
        backToTop.classList.remove('visible');
      }
    });

    backToTop.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  }

  // Copy Link Button
  const copyBtn = document.getElementById('copy-link-btn');
  const copyTooltip = document.getElementById('copy-tooltip');

  if (copyBtn && copyTooltip) {
    copyBtn.addEventListener('click', async () => {
      const url = copyBtn.dataset.url;
      try {
        await navigator.clipboard.writeText(url);
        copyTooltip.classList.add('show');
        setTimeout(() => copyTooltip.classList.remove('show'), 2000);
      } catch (err) {
        console.error('Failed to copy:', err);
      }
    });
  }
</script>

<style>
  .post-page {
    --bg: #050505;
    --bg-elevated: #0a0a0a;
    --bg-card: #0c0c0c;
    --text: #fafafa;
    --text-secondary: #a1a1aa;
    --text-muted: #52525b;
    --border: #1c1c1c;
    --accent: #8b5cf6;

    background: var(--bg);
    min-height: 100vh;
  }

  /* Header */
  .post-header {
    padding: 140px 24px 60px;
    position: relative;
  }

  .post-header::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--border), transparent);
  }

  .header-inner {
    max-width: 680px;
    margin: 0 auto;
  }

  .back-link {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 0.875rem;
    color: var(--text-muted);
    text-decoration: none;
    margin-bottom: 32px;
    transition: color 200ms ease;
  }

  .back-link:hover {
    color: var(--text-secondary);
  }

  .post-meta {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 16px;
  }

  .post-date, .post-author, .reading-time {
    font-size: 0.875rem;
    color: var(--text-muted);
  }

  .meta-dot {
    color: var(--text-muted);
  }

  .post-title {
    font-size: clamp(2rem, 5vw, 3rem);
    font-weight: 700;
    color: var(--text);
    line-height: 1.15;
    letter-spacing: -0.03em;
    margin: 0 0 16px 0;
  }

  .post-description {
    font-size: 1.125rem;
    color: var(--text-secondary);
    line-height: 1.6;
    margin: 0 0 24px 0;
  }

  .post-tags {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }

  .tag {
    font-size: 0.75rem;
    color: var(--accent);
    background: rgba(139, 92, 246, 0.1);
    padding: 4px 12px;
    border-radius: 4px;
  }

  /* Featured Image */
  .featured-image {
    padding: 0 24px 40px;
  }

  .image-inner {
    max-width: 800px;
    margin: 0 auto;
  }

  .featured-image img {
    width: 100%;
    height: auto;
    border-radius: 16px;
    border: 1px solid var(--border);
  }

  /* Content */
  .post-content {
    padding: 60px 24px 80px;
  }

  .content-inner {
    max-width: 680px;
    margin: 0 auto;
  }

  .prose {
    color: var(--text-secondary);
    font-size: 1.0625rem;
    line-height: 1.8;
  }

  .prose :global(h2) {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text);
    margin: 48px 0 16px 0;
    letter-spacing: -0.02em;
  }

  .prose :global(h3) {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text);
    margin: 36px 0 12px 0;
    letter-spacing: -0.01em;
  }

  .prose :global(p) {
    margin: 0 0 24px 0;
  }

  .prose :global(a) {
    color: var(--accent);
    text-decoration: none;
    border-bottom: 1px solid rgba(139, 92, 246, 0.3);
    transition: border-color 200ms ease;
  }

  .prose :global(a:hover) {
    border-color: var(--accent);
  }

  .prose :global(strong) {
    color: var(--text);
    font-weight: 600;
  }

  .prose :global(ul), .prose :global(ol) {
    margin: 0 0 24px 0;
    padding-left: 24px;
  }

  .prose :global(li) {
    margin-bottom: 8px;
  }

  .prose :global(blockquote) {
    border-left: 3px solid var(--accent);
    padding-left: 20px;
    margin: 32px 0;
    font-style: italic;
    color: var(--text-secondary);
  }

  .prose :global(code) {
    font-family: 'SF Mono', Monaco, monospace;
    font-size: 0.9em;
    color: var(--accent);
    background: rgba(139, 92, 246, 0.1);
    padding: 2px 6px;
    border-radius: 4px;
  }

  .prose :global(pre) {
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    overflow-x: auto;
    margin: 24px 0;
  }

  .prose :global(pre code) {
    background: none;
    padding: 0;
    color: var(--text-secondary);
  }

  .prose :global(hr) {
    border: none;
    border-top: 1px solid var(--border);
    margin: 48px 0;
  }

  /* Author */
  .author-section {
    padding: 0 24px 60px;
  }

  .author-inner {
    max-width: 680px;
    margin: 0 auto;
  }

  .author-card {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 24px;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: 16px;
  }

  .author-avatar-link {
    text-decoration: none;
    flex-shrink: 0;
  }

  .author-avatar {
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    color: white;
    font-size: 1.125rem;
    transition: transform 200ms ease;
  }

  .author-avatar-link:hover .author-avatar {
    transform: scale(1.05);
  }

  .author-info {
    flex: 1;
  }

  .author-name-link {
    text-decoration: none;
  }

  .author-name {
    font-size: 0.9375rem;
    font-weight: 600;
    color: var(--text);
    margin: 0 0 2px 0;
    transition: color 200ms ease;
  }

  .author-name-link:hover .author-name {
    color: var(--accent);
  }

  .author-bio {
    font-size: 0.8125rem;
    color: var(--text-muted);
    margin: 0;
  }

  .author-follow {
    font-size: 0.8125rem;
    font-weight: 600;
    color: var(--accent);
    background: rgba(139, 92, 246, 0.1);
    padding: 8px 16px;
    border-radius: 8px;
    text-decoration: none;
    transition: background 200ms ease;
  }

  .author-follow:hover {
    background: rgba(139, 92, 246, 0.2);
  }

  /* Comments */
  .comments-section {
    padding: 60px 24px;
    position: relative;
  }

  .comments-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--border), transparent);
  }

  .comments-inner {
    max-width: 680px;
    margin: 0 auto;
  }

  .comments-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text);
    margin: 0 0 24px 0;
    letter-spacing: -0.01em;
  }

  #giscus-container {
    min-height: 200px;
  }

  .comments-note {
    margin-top: 16px;
    font-size: 0.75rem;
    color: var(--text-muted);
    text-align: center;
  }

  .comments-note a {
    color: var(--accent);
    text-decoration: none;
  }

  .comments-note a:hover {
    text-decoration: underline;
  }

  /* Related Posts */
  .related-section {
    padding: 60px 24px;
    position: relative;
  }

  .related-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--border), transparent);
  }

  .related-inner {
    max-width: 900px;
    margin: 0 auto;
  }

  .related-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text);
    margin: 0 0 24px 0;
    letter-spacing: -0.01em;
  }

  .related-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 16px;
  }

  .related-card {
    padding: 20px;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: 12px;
    text-decoration: none;
    transition: all 200ms ease;
  }

  .related-card:hover {
    border-color: #2a2a2a;
    transform: translateY(-2px);
  }

  .related-date {
    font-size: 0.75rem;
    color: var(--text-muted);
    display: block;
    margin-bottom: 8px;
  }

  .related-heading {
    font-size: 0.9375rem;
    font-weight: 600;
    color: var(--text);
    margin: 0 0 12px 0;
    line-height: 1.4;
    transition: color 200ms ease;
  }

  .related-card:hover .related-heading {
    color: var(--accent);
  }

  .related-link {
    font-size: 0.8125rem;
    color: var(--text-muted);
  }

  /* Footer CTA */
  .footer-cta {
    padding: 60px 24px;
    position: relative;
  }

  .footer-cta::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--border), transparent);
  }

  .cta-inner {
    max-width: 400px;
    margin: 0 auto;
    text-align: center;
  }

  .cta-text {
    font-size: 0.9375rem;
    color: var(--text-secondary);
    margin: 0 0 16px 0;
  }

  .cta-link {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 0.9375rem;
    font-weight: 500;
    color: var(--accent);
    text-decoration: none;
    transition: gap 200ms ease, opacity 200ms ease;
  }

  .cta-link:hover {
    gap: 10px;
    opacity: 0.8;
  }

  /* Responsive */
  @media (max-width: 600px) {
    .post-header {
      padding: 120px 16px 40px;
    }

    .post-content {
      padding: 40px 16px 60px;
    }

    .author-section {
      padding: 0 16px 40px;
    }

    .author-card {
      flex-direction: column;
      text-align: center;
    }

    .author-info {
      flex: none;
    }

    .related-section {
      padding: 40px 16px;
    }

    .related-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
